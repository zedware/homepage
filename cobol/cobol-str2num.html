<html>

<!-- PLOC = d.article.thread -->

<!-- CID = 10260 -->

<!-- CHAN_LOC = cat.comptech.devenv -->

<!-- GROUP = comp.lang.cobol -->

<head>

  <meta name="keywords" content="deja, dejanews, usenet, newsgroup, articles, search, query, discussion">

  <meta name="zedware"
    content="一得斋,数据库管理系统,大机,DBMS,ORACLE,SQL Server,Sybase,DB2,Access,ORDBMS,SQL,ODBC,JDBC,OLEDB,ADO,SQL99,SQL3,SQL92,COBOL,CICS,OS390">

  <title>Deja.com: Re: Moving a PIC X(20) to PIC S9(8)V9(2) COMP 3 fi</title>

  <style>
    <!--
    #blue {
      color: #6666cc;
    }

    #gray {
      color: #666677;
    }

    #green {
      color: #cccc66;
    }

    #grey {
      color: #666677;
    }

    #indigo {
      color: #003399;
    }

    #lilac {
      color: #ccccff;
    }

    #reallyred {
      color: #cc0000;
    }

    #red {
      color: #ff6600;
    }

    #white {
      color: #ffffff;
    }

    #yellow {
      color: #ffcc66;
    }

    .boldorange {
      color: #ff6600;
      font-family: geneva, arial;
      font-size: 18px;
      font-weight: bold;
    }

    .chicago {
      font-family: chicago, arial black, arial;
      font-size: 55em;
      letter-spacing: 0pt;
    }

    .courier {
      font-family: courier new, courier;
      font-size: 12px;
      letter-spacing: 0pt;
    }

    .large {
      font-family: geneva, arial;
      font-size: 11pt;
      letter-spacing: 1pt;
    }

    .med {
      font-family: geneva, arial;
      font-size: 9.25pt;
      letter-spacing: 0pt;
    }

    .menu {
      background-color: #ffffff;
      border-color: #000000;
      border-style: solid;
      border-width: 2px;
      color: #000000;
      font-family: geneva, arial;
      font-size: 10px;
      font-weight: normal;
      layer-background-color: #ffffff;
      padding: 0px;
      position: absolute;
      visibility: hidden;
      width: 165;
    }

    .size10 {
      font-family: geneva, arial;
      font-size: .10pt;
    }

    .size12 {
      font-family: geneva, arial;
      font-size: .12pt;
    }

    .size8 {
      font-family: geneva, arial;
      font-size: .8pt;
    }

    .small {
      font-family: geneva, arial;
      font-size: 7.85pt;
      letter-spacing: 0pt;
    }

    .verdana {
      font-family: verdana, geneva, arial;
      font-size: 7pt;
      letter-spacing: 0pt;
    }

    .xlarge {
      font-family: geneva, arial;
      font-size: 18px;
      letter-spacing: 0pt;
    }

    .xxlarge {
      font-family: geneva, arial;
      font-size: 18pt;
      letter-spacing: 0pt;
    }

    A.DARK2 {
      color: #ff6600;
    }

    A.DARK3 {
      color: #ff3300;
    }

    A.LIGHT2 {
      color: #ffcc66;
    }

    b.bold {
      color: #000000;
      font-family: geneva, arial;
      font-size: 9.25pt;
      font-weight: bold;
      letter-spacing: 0pt;
    }

    td {
      font-family: geneva, arial;
      font-size: 9.25pt;
      letter-spacing: 0pt;
    }

    td B {
      font-family: geneva, arial;
      font-size: 9.25pt;
      font-weight: bold;
      letter-spacing: 0pt;
    }
    -->

  </style>

  <script>

< !--

      function goOpener(myLink, closeme, closeonly) {

        if (!(window.focus && window.opener)) return true;

        window.opener.focus();

        if (!closeonly) window.opener.location.href = myLink.href;

        if (closeme) window.close();

        return false;

      }

    function close_window(milliseconds) {

      setTimeout('self.close()', milliseconds);

    }

    function popup_1(url, width, height, scrollbars) {

      var urlpat = /^http:/;

      if (!urlpat.test(url)) {

        url = 'http://www.deja.com/' + url;

      }

      width = width || 350;

      height = height || 480;

      scrollbars = scrollbars || 'no';

      var props = 'toolbar=no,location=no,status=no,scrollbars=' + scrollbars + ',menubar=no,resizable=yes,copyhistory=no,width=' + width + ',height=' + height;

      rateWin = window.open(url, 'popup_1', props);

      window.name = "mainWindow"; // this renames the "main" browser window

      rateWin.resizeTo(width, height); // this resizes the popup 

      rateWin.focus(); // this brings the popup to focus

    }

    function popup_ext(url, width, height, scrollbars) {

      width = width || 640;

      height = height || 480;

      scrollbars = scrollbars || 'no';

      var props = 'toolbar=no,location=no,status=no,scrollbars=' + scrollbars + ',menubar=no,resizable=yes,copyhistory=no,width=' + width + ',height=' + height;

      indrevWin = window.open(url, 'popup_ext', props);

      window.name = "mainWindow"; // this renames the "main" browser window

      indrevWin.focus(); // this brings the popup to focus

    }

    function backorClose() {

      var histCount = window.history.length

      if (histCount >= 1) {

        window.history.back(1)

      } else {

        window.close()

      }

    }

// -->

  </script>

  <base href="http://www.deja.com/" name="main">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2QMPH4XTZX"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-2QMPH4XTZX');
  </script>
</head>

<body bgcolor=#ffffff text=#000000 link=#0000cc vlink=#663399 alink=#ff6600>

  <p>Copy from comp.lang.cobol in deja.com, not validated!</p>

  <table border=0 cellspacing=0 cellpadding=2 width=100%>

    <tr valign=top>

      <td width="11%"><span class="small"><b class="small" id=red>&gt;&gt;</b> <a
            href="http://x51.deja.com/viewthread.xp?thitnum=8&mhitnum=5&AN=694659671.1&CONTEXT=974720062.859766863&frpage=threadmsg_md.xp&recnum=%3c8v2rge$77i$1@oslo-nntp.eunet.no%3e%231/1&back=comp.lang.cobol">Thread</a>:</span>
      </td>

      <td width="89%"><a
          href="http://www.deja.com/profile.xp?author=%22Erlend%20Moen%22%20%3cerlend.moen@disys.no%3e&ST=PS"><b><span
              class="small">

              <b class="small">Moving a PIC X(20) to PIC S9(8)V9(2) COMP 3 field</b></span></b></a></td>

    </tr>

  </table>

  <table border=0 cellspacing=0 cellpadding=2 width=100%>

    <tr valign=top>

      <td width="11%"><span class="small"><b class="small" id=red>&gt;&gt;</b> <a
            href="http://x51.deja.com/topics_md.xp?search=next&offset=0&CONTEXT=974720062.859766863">Forum</a></span>
      </td>

      <td width="89%"><a
          href="http://www.deja.com/profile.xp?author=%22Erlend%20Moen%22%20%3cerlend.moen@disys.no%3e&ST=PS"><b><span
              class="small">

              <b class="small">comp.lang.cobo</b></span>l</b></a></td>

    </tr>

  </table>

  <table border=0 cellspacing=0 cellpadding=2 width=100%>

    <tr valign=top>

      <td width="11%">Subject:</td>

      <td width=89%><b>Re: Moving a PIC X(20) to PIC S9(8)V9(2) COMP 3 field</b></td>

    </tr>

  </table>

  <table border=0 cellspacing=0 cellpadding=2 width=100%>

    <tr valign=top>

      <td width="11%">Date:</td>

      <td width="89%">11/17/2000</td>

    </tr>

    <tr valign=top>

      <td width="11%">Author:</td>

      <td width="89%"><a
          href="http://www.deja.com/profile.xp?author=%22Erlend%20Moen%22%20%3cerlend.moen@disys.no%3e&ST=PS"><b>Erlend

            Moen</b></a> &lt;<a href="mailto:erlend.moen@disys.no">erlend.moen@disys.no</a>&gt;</td>

    </tr>

  </table>

  <p>Craig &lt;<a
      href="http://www.deja.com/profile.xp?author=craigstewart9999@my-deja.com&ST=PS">craigstewart9999@my-deja.com</a>&gt;

    skrev i<br>

    news:8v1qpm$8vi$1@nnrp1.deja.com<br>

    <font color="#666600">&gt;<br>

    </font>
    <font color="#ff3300">&gt; &gt; I often have to import data from other

      sources into our accounting-<br>

    </font>
    <font color="#666600">&gt; system. I<br>

    </font>
    <font color="#ff3300">&gt; &gt; have ended up with a little routine

      that &quot;chews&quot; on any given string<br>

    </font>
    <font color="#666600">&gt; and<br>

      &gt;<br>

      &gt; That would be greatly appreciated. my e-mail address is<br>

    </font> &nbsp;<br>

    Ok, here it is. It's two copy-files. This is a routine I have developed to handle

    many weird input-formats, that's why I gave up finding a singel function for

    this. It was not possible... hope this will help you! Btw: The variable-names

    are in Norwegian, I didn't bother to translate them, I tried to translate my

    comments however.<br>

    &nbsp;<br>

    WSSTR2N.CPY:<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; 01&nbsp; STR2NUM.<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03&nbsp; STR2NUM-DESIMALPUNKT PIC X VALUE

    &quot;.&quot;.<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03&nbsp; STR2NUM-STRENG&nbsp; &nbsp; &nbsp;

    PIC X(18).<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03&nbsp; STR2NUM-NEGATIV&nbsp; &nbsp; &nbsp;

    PIC S9.<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03&nbsp; STR2NUM-DESIMAL&nbsp; &nbsp; &nbsp;

    PIC 9.<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03&nbsp; STR2NUM-TALL&nbsp; &nbsp; &nbsp;

    &nbsp; PIC S9(9)V9(9).<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03&nbsp; STR2NUM-NUM&nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; PIC 9(9)V9(9).<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03&nbsp; FILLER REDEFINES STR2NUM-NUM.<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 05&nbsp; STR2NUM-HELTALL&nbsp;

    PIC X(9).<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 05&nbsp; STR2NUM-DELTALL&nbsp;

    PIC X(9).<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03&nbsp; STR2NUM-TELLER1&nbsp; &nbsp; &nbsp;

    PIC 9(9).<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03&nbsp; STR2NUM-TELLER2&nbsp; &nbsp; &nbsp;

    PIC 9(9).<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 03&nbsp; STR2NUM-TELLER3&nbsp; &nbsp; &nbsp;

    PIC 9(9).<br>

    &nbsp;<br>

    &nbsp;<br>

    STR2N.CPY:<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; *STR2N.CPY<br>

    &nbsp; &nbsp; &nbsp; *<br>

    &nbsp; &nbsp; &nbsp; *1999-12-08 EM<br>

    &nbsp; &nbsp; &nbsp; *<br>

    &nbsp; &nbsp; &nbsp; *This routine converts a string to a number defined as

    S9(9)V9(9). &nbsp; &nbsp; &nbsp; *The input-value is a string with a length

    of up to 18 characters. It may<br>

    &nbsp; &nbsp; &nbsp; *be right- or left-justified or even centered. Decimal-point

    can be configured<br>

    &nbsp; &nbsp; &nbsp; *and can be set in the variable STR2NUM-DESIMALPUNKT. Default

    is &quot;.&quot;. It also<br>

    &nbsp; &nbsp; &nbsp; *handles negative values.<br>

    &nbsp; &nbsp; &nbsp; *<br>

    &nbsp; &nbsp; &nbsp; *To use the routine, just set STR2NUM-DESIMALPUNKT to any

    desired value<br>

    &nbsp; &nbsp; &nbsp; *if it differs from &quot;.&quot;. Then, move the string

    into STR2NUM-STRENG and perform<br>

    &nbsp; &nbsp; &nbsp; *STR2NUM. The result will be generated in STR2NUM-TALL.<br>

    &nbsp; &nbsp; &nbsp; *The variables for this routine is found in WSSTR2N.CPY.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; STR2NUM SECTION.<br>

    &nbsp; &nbsp; &nbsp; STR2NUM-001.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INITIALIZE STR2NUM-NEGATIV<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    STR2NUM-DESIMAL<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    STR2NUM-NUM<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    TO STR2NUM-TALL.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INSPECT STR2NUM-STRENG&nbsp; TALLYING STR2NUM-DESIMAL<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FOR ALL STR2NUM-DESIMALPUNKT.

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INSPECT STR2NUM-STRENG&nbsp; TALLYING STR2NUM-NEGATIV<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FOR ALL &quot;-&quot;.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF&nbsp; &nbsp; &nbsp; STR2NUM-NEGATIV&nbsp;

    &gt; 0<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVE -1&nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; TO STR2NUM-NEGATIV<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSE<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVE 1&nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; TO STR2NUM-NEGATIV.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF&nbsp; &nbsp; &nbsp; STR2NUM-DESIMAL&nbsp;

    = 0<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVE 18&nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; TO STR2NUM-TELLER2<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GO TO&nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; STR2NUM-010.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; *Finding the position of the first decimal digit<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PERFORM&nbsp; WITH TEST AFTER<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VARYING

    STR2NUM-TELLER1 FROM 18 BY -1<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UNTIL

    STR2NUM-TELLER1 = 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; IF&nbsp; STR2NUM-STRENG(STR2NUM-TELLER1:1) =<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; STR2NUM-DESIMALPUNKT &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ADD 1 TO STR2NUM-TELLER1

    GIVING STR2NUM-TELLER2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; MOVE 1&nbsp; &nbsp; &nbsp; TO STR2NUM-TELLER1<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END-IF<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END-PERFORM.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVE&nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; TO STR2NUM-TELLER3.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; *Filling decimal-part<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PERFORM WITH TEST AFTER<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VARYING STR2NUM-TELLER1<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM STR2NUM-TELLER2

    BY 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UNTIL STR2NUM-TELLER1

    = 18 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF&nbsp;

    STR2NUM-STRENG(STR2NUM-TELLER1:1) NOT &lt; &quot;0&quot; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; AND&nbsp; STR2NUM-STRENG(STR2NUM-TELLER1:1)

    NOT &gt; &quot;9&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; MOVE STR2NUM-STRENG(STR2NUM-TELLER1:1) TO &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STR2NUM-DELTALL(STR2NUM-TELLER3:1)

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; ADD 1&nbsp; &nbsp; &nbsp; TO STR2NUM-TELLER3<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END-IF<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END-PERFORM.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; *The position of the last digit in the integer<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SUBTRACT 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; FROM STR2NUM-TELLER2.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; STR2NUM-010.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVE&nbsp; &nbsp; 9&nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; TO STR2NUM-TELLER3.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; *Filling the integer-part<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PERFORM WITH TEST AFTER<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; VARYING STR2NUM-TELLER1

    FROM STR2NUM-TELLER2 BY -1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; UNTIL STR2NUM-TELLER1 = 1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; IF&nbsp; STR2NUM-STRENG(STR2NUM-TELLER1:1) NOT &lt;

    &quot;0&quot; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    AND&nbsp; STR2NUM-STRENG(STR2NUM-TELLER1:1) NOT &gt; &quot;9&quot; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVE STR2NUM-STRENG(STR2NUM-TELLER1:1)

    TO &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STR2NUM-HELTALL(STR2NUM-TELLER3:1)

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; SUBTRACT 1&nbsp; FROM STR2NUM-TELLER3<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; IF&nbsp; STR2NUM-TELLER3 = 0<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; MOVE 1 TO STR2NUM-TELLER2<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; END-IF<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END-IF<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; END-PERFORM.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOVE&nbsp; &nbsp; STR2NUM-NUM&nbsp; &nbsp;

    &nbsp; TO STR2NUM-TALL.<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MULTIPLY STR2NUM-TALL&nbsp; &nbsp; BY STR2NUM-NEGATIV<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GIVING STR2NUM-TALL.<br>

    &nbsp;<br>

    &nbsp; &nbsp; &nbsp; STR2NUM-900.<br>

    &nbsp; &nbsp; &nbsp; STR2NUM-EXIT.<br>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EXIT.<br>

    &nbsp;<br>

    <font face="courier" size=2>--<br>

      Regards,<br>

      Erlend Moen<br>

      DI Systemer AS<br>

      Norway</font>
  </p>

</body>

</html>