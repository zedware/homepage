*ASM XOPTS(NOEPILOG)

         TITLE 'CHANGE 8-BYTE-HEX TO 16-BYTE-CHAR'

*        AUTHOR uniware@zedware.org 

         EJECT

*----------------------------------------------------------------------

*        MACRO SYS1.MACLIB(YREGS)

*----------------------------------------------------------------------

         YREGS

COMMREG  EQU    R7

*----------------------------------------------------------------------

*        DYNAMIC STORAGE

*----------------------------------------------------------------------

         DFHEISTG

OPBUF    DS     CL08

*-------------------------------------------------------------------

*        LINKAGE SECTION

*-------------------------------------------------------------------

LINKAREA DSECT

         USING *,COMMREG

HEXBUF   DS     XL08

CHARBUF  DS     CL16

RETCODE  DS     CL01

*-------------------------------------------------------------------

*        MAIN PROCEDURE

*-------------------------------------------------------------------

CONVERT  DFHEIENT CODEREG=(3,4)

         EXEC  CICS HANDLE ABEND LABEL(ABND)

         L     COMMREG,DFHEICAP

*

         MVC   OPBUF,HEXBUF

         MVC   CHARBUF+0(1),OPBUF+0

         MVC   CHARBUF+1(1),OPBUF+0

         MVC   CHARBUF+2(1),OPBUF+1

         MVC   CHARBUF+3(1),OPBUF+1

         MVC   CHARBUF+4(1),OPBUF+2

         MVC   CHARBUF+5(1),OPBUF+2

         MVC   CHARBUF+6(1),OPBUF+3

         MVC   CHARBUF+7(1),OPBUF+3

         MVC   CHARBUF+8(1),OPBUF+4

         MVC   CHARBUF+9(1),OPBUF+4

         MVC   CHARBUF+10(1),OPBUF+5

         MVC   CHARBUF+11(1),OPBUF+5

         MVC   CHARBUF+12(1),OPBUF+6

         MVC   CHARBUF+13(1),OPBUF+6

         MVC   CHARBUF+14(1),OPBUF+7

         MVC   CHARBUF+15(1),OPBUF+7

         NC    CHARBUF,OPCHAR

         TR    CHARBUF,TABLE

ABND     EQU   *

         MVI   RETCODE,C'1'

         B     RETURN

RETURN0  EQU   *

         MVI   RETCODE,C'0'

RETURN   EQU   *

         EXEC  CICS RETURN

         EJECT

*

         LTORG

         DS    0D

OPCHAR   DC    X'F00FF00FF00FF00FF00FF00FF00FF00F'

         DS    0D

TABLE    EQU   *

         DC    X'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'

         DC    X'F11112131415161718191A1B1C1D1E1F'

         DC    X'F25A7F7B5B6C507D4D5D5C4C6B604B61'

         DC    X'F3F1F2F3F4F5F6F7F8F97A5E4C7E6E6F'

         DC    X'F4C1C2C3C4C5C6C7C8C9D1D2D3D4D5D6'

         DC    X'F5D8D9E2E3E4E5E6E7E8E95FE04F4A6D'

         DC    X'F6818283848586878889919293949596'

         DC    X'F79899A2A3A4A5A6A7A8A9C06AD0A17F'

         DC    X'F88182838485868788898A8B8C8D8E8F'

         DC    X'F99192939495969798999A9B9C9D9E9F'

         DC    X'C1A1A2A3A4A5A6A7A8A9AAABACADAEAF'

         DC    X'C2B1B2B3B4B5B6B7B8B9BABBBCBDBEBF'

         DC    X'C3C1C2C3C4C5C6C7C8C9CACBCCCDCECF'

         DC    X'C4D1D2D3D4D5D6D7D8D9DADBDCDDDEDF'

         DC    X'C5E1E2E3E4E5E6E7E8E9EAEBECEDEEEF'

         DC    X'C6F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'

         END

